{"ast":null,"code":"import axios from\"axios\";import*as actionTypes from\"./actionTypes\";export var authStart=function authStart(){return{type:actionTypes.AUTH_START};};export var authSuccess=function authSuccess(token,userId){return{type:actionTypes.AUTH_SUCCESS,idToken:token,userId:userId};};export var authFailed=function authFailed(error){return{type:actionTypes.AUTH_FAILED,error:error};};export var logout=function logout(){localStorage.removeItem(\"token\");localStorage.removeItem(\"expirationDate\");localStorage.removeItem(\"userId\");return{type:actionTypes.AUTH_LOGOUT};};export var checkAuthTimeout=function checkAuthTimeout(expirationTime){return function(dispatch){setTimeout(function(){dispatch(logout());},expirationTime*1000);};};export var auth=function auth(email,password,isSignup){return function(dispatch){dispatch(authStart());var authData={email:email,password:password,returnSecureToken:true};var url=\"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyC7Z7IBWL-_SLT1bjJ3w9GY5XAC7-1ogb8\";if(!isSignup){url=\"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyC7Z7IBWL-_SLT1bjJ3w9GY5XAC7-1ogb8\";}axios.post(url,authData).then(function(response){var expirationDate=new Date(new Date().getTime()+response.data.expiresIn*1000);localStorage.setItem(\"token\",response.data.idToken);localStorage.setItem(\"expirationDate\",expirationDate);localStorage.setItem(\"userId\",response.data.localId);dispatch(authSuccess(response.data.idToken,response.data.localId));dispatch(checkAuthTimeout(response.data.expiresIn));}).catch(function(error){dispatch(authFailed(error.response.data.error));});};};export var setAuthRediectPath=function setAuthRediectPath(path){return{type:actionTypes.SET_AUTH_REDIRECT_PATH,path:path};};export var authCheckState=function authCheckState(){return function(dispatch){var token=localStorage.getItem(\"token\");if(!token){dispatch(logout());}else{var expirationDate=new Date(localStorage.getItem(\"expirationDate\"));if(expirationDate<=new Date()){dispatch(logout());}else{var userId=localStorage.getItem(\"userId\");dispatch(authSuccess(token,userId));dispatch(checkAuthTimeout((expirationDate.getTime()-new Date().getTime())/1000));}}};};","map":{"version":3,"sources":["/Users/ump/Desktop/Udemy/React The Complete Guide(incl Hooks,React Rounter,Redux)/burgerbuilder/src/store/actions/auth.js"],"names":["axios","actionTypes","authStart","type","AUTH_START","authSuccess","token","userId","AUTH_SUCCESS","idToken","authFailed","error","AUTH_FAILED","logout","localStorage","removeItem","AUTH_LOGOUT","checkAuthTimeout","expirationTime","dispatch","setTimeout","auth","email","password","isSignup","authData","returnSecureToken","url","post","then","response","expirationDate","Date","getTime","data","expiresIn","setItem","localId","catch","setAuthRediectPath","path","SET_AUTH_REDIRECT_PATH","authCheckState","getItem"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAO,GAAKC,CAAAA,WAAZ,KAA6B,eAA7B,CAEA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CAC9B,MAAO,CACNC,IAAI,CAAEF,WAAW,CAACG,UADZ,CAAP,CAGA,CAJM,CAMP,MAAO,IAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAQC,MAAR,CAAmB,CAC7C,MAAO,CACNJ,IAAI,CAAEF,WAAW,CAACO,YADZ,CAENC,OAAO,CAAEH,KAFH,CAGNC,MAAM,CAAEA,MAHF,CAAP,CAKA,CANM,CAQP,MAAO,IAAMG,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,KAAD,CAAW,CACpC,MAAO,CACNR,IAAI,CAAEF,WAAW,CAACW,WADZ,CAEND,KAAK,CAAEA,KAFD,CAAP,CAIA,CALM,CAOP,MAAO,IAAME,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CAC3BC,YAAY,CAACC,UAAb,CAAwB,OAAxB,EACAD,YAAY,CAACC,UAAb,CAAwB,gBAAxB,EACAD,YAAY,CAACC,UAAb,CAAwB,QAAxB,EACA,MAAO,CACNZ,IAAI,CAAEF,WAAW,CAACe,WADZ,CAAP,CAGA,CAPM,CASP,MAAO,IAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,cAAD,CAAoB,CACnD,MAAO,UAACC,QAAD,CAAc,CACpBC,UAAU,CAAC,UAAM,CAChBD,QAAQ,CAACN,MAAM,EAAP,CAAR,CACA,CAFS,CAEPK,cAAc,CAAG,IAFV,CAAV,CAGA,CAJD,CAKA,CANM,CAQP,MAAO,IAAMG,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,CAACC,KAAD,CAAQC,QAAR,CAAkBC,QAAlB,CAA+B,CAClD,MAAO,UAACL,QAAD,CAAc,CACpBA,QAAQ,CAACjB,SAAS,EAAV,CAAR,CACA,GAAMuB,CAAAA,QAAQ,CAAG,CAChBH,KAAK,CAAEA,KADS,CAEhBC,QAAQ,CAAEA,QAFM,CAGhBG,iBAAiB,CAAE,IAHH,CAAjB,CAKA,GAAIC,CAAAA,GAAG,CACN,uGADD,CAEA,GAAI,CAACH,QAAL,CAAe,CACdG,GAAG,CACF,mHADD,CAEA,CACD3B,KAAK,CACH4B,IADF,CACOD,GADP,CACYF,QADZ,EAEEI,IAFF,CAEO,SAACC,QAAD,CAAc,CACnB,GAAMC,CAAAA,cAAc,CAAG,GAAIC,CAAAA,IAAJ,CACtB,GAAIA,CAAAA,IAAJ,GAAWC,OAAX,GAAuBH,QAAQ,CAACI,IAAT,CAAcC,SAAd,CAA0B,IAD3B,CAAvB,CAGArB,YAAY,CAACsB,OAAb,CAAqB,OAArB,CAA8BN,QAAQ,CAACI,IAAT,CAAczB,OAA5C,EACAK,YAAY,CAACsB,OAAb,CAAqB,gBAArB,CAAuCL,cAAvC,EACAjB,YAAY,CAACsB,OAAb,CAAqB,QAArB,CAA+BN,QAAQ,CAACI,IAAT,CAAcG,OAA7C,EACAlB,QAAQ,CAACd,WAAW,CAACyB,QAAQ,CAACI,IAAT,CAAczB,OAAf,CAAwBqB,QAAQ,CAACI,IAAT,CAAcG,OAAtC,CAAZ,CAAR,CACAlB,QAAQ,CAACF,gBAAgB,CAACa,QAAQ,CAACI,IAAT,CAAcC,SAAf,CAAjB,CAAR,CACA,CAXF,EAYEG,KAZF,CAYQ,SAAC3B,KAAD,CAAW,CACjBQ,QAAQ,CAACT,UAAU,CAACC,KAAK,CAACmB,QAAN,CAAeI,IAAf,CAAoBvB,KAArB,CAAX,CAAR,CACA,CAdF,EAeA,CA5BD,CA6BA,CA9BM,CAgCP,MAAO,IAAM4B,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACC,IAAD,CAAU,CAC3C,MAAO,CACNrC,IAAI,CAAEF,WAAW,CAACwC,sBADZ,CAEND,IAAI,CAAEA,IAFA,CAAP,CAIA,CALM,CAOP,MAAO,IAAME,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CACnC,MAAO,UAACvB,QAAD,CAAc,CACpB,GAAMb,CAAAA,KAAK,CAAGQ,YAAY,CAAC6B,OAAb,CAAqB,OAArB,CAAd,CACA,GAAI,CAACrC,KAAL,CAAY,CACXa,QAAQ,CAACN,MAAM,EAAP,CAAR,CACA,CAFD,IAEO,CACN,GAAMkB,CAAAA,cAAc,CAAG,GAAIC,CAAAA,IAAJ,CAASlB,YAAY,CAAC6B,OAAb,CAAqB,gBAArB,CAAT,CAAvB,CACA,GAAIZ,cAAc,EAAI,GAAIC,CAAAA,IAAJ,EAAtB,CAAkC,CACjCb,QAAQ,CAACN,MAAM,EAAP,CAAR,CACA,CAFD,IAEO,CACN,GAAMN,CAAAA,MAAM,CAAGO,YAAY,CAAC6B,OAAb,CAAqB,QAArB,CAAf,CACAxB,QAAQ,CAACd,WAAW,CAACC,KAAD,CAAQC,MAAR,CAAZ,CAAR,CACAY,QAAQ,CACPF,gBAAgB,CACf,CAACc,cAAc,CAACE,OAAf,GAA2B,GAAID,CAAAA,IAAJ,GAAWC,OAAX,EAA5B,EAAoD,IADrC,CADT,CAAR,CAKA,CACD,CACD,CAlBD,CAmBA,CApBM","sourcesContent":["import axios from \"axios\";\n\nimport * as actionTypes from \"./actionTypes\";\n\nexport const authStart = () => {\n\treturn {\n\t\ttype: actionTypes.AUTH_START,\n\t};\n};\n\nexport const authSuccess = (token, userId) => {\n\treturn {\n\t\ttype: actionTypes.AUTH_SUCCESS,\n\t\tidToken: token,\n\t\tuserId: userId,\n\t};\n};\n\nexport const authFailed = (error) => {\n\treturn {\n\t\ttype: actionTypes.AUTH_FAILED,\n\t\terror: error,\n\t};\n};\n\nexport const logout = () => {\n\tlocalStorage.removeItem(\"token\");\n\tlocalStorage.removeItem(\"expirationDate\");\n\tlocalStorage.removeItem(\"userId\");\n\treturn {\n\t\ttype: actionTypes.AUTH_LOGOUT,\n\t};\n};\n\nexport const checkAuthTimeout = (expirationTime) => {\n\treturn (dispatch) => {\n\t\tsetTimeout(() => {\n\t\t\tdispatch(logout());\n\t\t}, expirationTime * 1000);\n\t};\n};\n\nexport const auth = (email, password, isSignup) => {\n\treturn (dispatch) => {\n\t\tdispatch(authStart());\n\t\tconst authData = {\n\t\t\temail: email,\n\t\t\tpassword: password,\n\t\t\treturnSecureToken: true,\n\t\t};\n\t\tlet url =\n\t\t\t\"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyC7Z7IBWL-_SLT1bjJ3w9GY5XAC7-1ogb8\";\n\t\tif (!isSignup) {\n\t\t\turl =\n\t\t\t\t\"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyC7Z7IBWL-_SLT1bjJ3w9GY5XAC7-1ogb8\";\n\t\t}\n\t\taxios\n\t\t\t.post(url, authData)\n\t\t\t.then((response) => {\n\t\t\t\tconst expirationDate = new Date(\n\t\t\t\t\tnew Date().getTime() + response.data.expiresIn * 1000\n\t\t\t\t);\n\t\t\t\tlocalStorage.setItem(\"token\", response.data.idToken);\n\t\t\t\tlocalStorage.setItem(\"expirationDate\", expirationDate);\n\t\t\t\tlocalStorage.setItem(\"userId\", response.data.localId);\n\t\t\t\tdispatch(authSuccess(response.data.idToken, response.data.localId));\n\t\t\t\tdispatch(checkAuthTimeout(response.data.expiresIn));\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tdispatch(authFailed(error.response.data.error));\n\t\t\t});\n\t};\n};\n\nexport const setAuthRediectPath = (path) => {\n\treturn {\n\t\ttype: actionTypes.SET_AUTH_REDIRECT_PATH,\n\t\tpath: path,\n\t};\n};\n\nexport const authCheckState = () => {\n\treturn (dispatch) => {\n\t\tconst token = localStorage.getItem(\"token\");\n\t\tif (!token) {\n\t\t\tdispatch(logout());\n\t\t} else {\n\t\t\tconst expirationDate = new Date(localStorage.getItem(\"expirationDate\"));\n\t\t\tif (expirationDate <= new Date()) {\n\t\t\t\tdispatch(logout());\n\t\t\t} else {\n\t\t\t\tconst userId = localStorage.getItem(\"userId\");\n\t\t\t\tdispatch(authSuccess(token, userId));\n\t\t\t\tdispatch(\n\t\t\t\t\tcheckAuthTimeout(\n\t\t\t\t\t\t(expirationDate.getTime() - new Date().getTime()) / 1000\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n};\n"]},"metadata":{},"sourceType":"module"}